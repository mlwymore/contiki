<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">

<title>Hardware Abstraction Level: System_timer</title>

<LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">

</head><body>

<table border="0" cellspacing="0" cellpadding="0"  width=100%>

<tr>

<td><img src="ST_Logo.gif"></td>

<td> <div class="qindex">

<a class="qindex" href="index.html">Home</a>&nbsp;

 | &nbsp;<a class="qindex" href="modules.html">Modules</a>&nbsp;

 | &nbsp;<a class="qindex" href="annotated.html">Data Structures</a>&nbsp;

 | &nbsp;<a class="qindex" href="files.html">File List</a>&nbsp;

 | &nbsp;<a class="qindex" href="globals.html">Index</a></div>

</td>

</table>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>System_timer</h1>
<p>Functions that provide access to the system clock.  
<a href="#_details">More...</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__iar.html#ga409a5c4bea6981c30b308684efa33f6f">int16u</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__system__timer.html#gae0b935fd7ac5ee0070e31fb43bf82fba">halInternalStartSystemTimer</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initializes the system tick.  <a href="#gae0b935fd7ac5ee0070e31fb43bf82fba"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__iar.html#ga409a5c4bea6981c30b308684efa33f6f">int16u</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__system__timer.html#gacbbf0cd5321a6bd054b7e99c7b492f08">halCommonGetInt16uMillisecondTick</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the current system time in system ticks, as a 16-bit value.  <a href="#gacbbf0cd5321a6bd054b7e99c7b492f08"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__iar.html#ga2ba8e0357fdc7b7a450e6893ed81e8e3">int32u</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__system__timer.html#ga7033d63e4ee56452e3e6c67d49f01ef2">halCommonGetInt32uMillisecondTick</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the current system time in system ticks, as a 32-bit value.  <a href="#ga7033d63e4ee56452e3e6c67d49f01ef2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__iar.html#ga409a5c4bea6981c30b308684efa33f6f">int16u</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__system__timer.html#ga5aec52f8f5e5b85acacfb41a4a437593">halCommonGetInt16uQuarterSecondTick</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the current system time in quarter second ticks, as a 16-bit value.  <a href="#ga5aec52f8f5e5b85acacfb41a4a437593"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__micro.html#gafddf1f4a9c9eff790d56c8950c1fb0ad">StStatus</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__system__timer.html#ga93a6eee07d54f4485ee7d41d20377e33">halSleepForQuarterSeconds</a> (<a class="el" href="group__iar.html#ga2ba8e0357fdc7b7a450e6893ed81e8e3">int32u</a> *duration)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Uses the system timer to enter <a class="el" href="group__micro.html#ggabed82baf7f470b522273a3e37c24c600a93af1c45a33be62df00d0ab82ef04128">SLEEPMODE_WAKETIMER</a> for approximately the specified amount of time (provided in quarter seconds).  <a href="#ga93a6eee07d54f4485ee7d41d20377e33"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__micro.html#gafddf1f4a9c9eff790d56c8950c1fb0ad">StStatus</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__system__timer.html#gabf8fd2835f043631b926c49965ea178f">halIdleForMilliseconds</a> (<a class="el" href="group__iar.html#ga2ba8e0357fdc7b7a450e6893ed81e8e3">int32u</a> *duration)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Uses the system timer to enter <a class="el" href="group__micro.html#ggabed82baf7f470b522273a3e37c24c600a8dec81d54908044ef56016aee3b1b506">SLEEPMODE_IDLE</a> for approximately the specified amount of time (provided in milliseconds).  <a href="#gabf8fd2835f043631b926c49965ea178f"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Functions that provide access to the system clock. </p>
<p>A single system tick (as returned by <a class="el" href="group__system__timer.html#gacbbf0cd5321a6bd054b7e99c7b492f08" title="Returns the current system time in system ticks, as a 16-bit value.">halCommonGetInt16uMillisecondTick()</a> and <a class="el" href="group__system__timer.html#ga7033d63e4ee56452e3e6c67d49f01ef2" title="Returns the current system time in system ticks, as a 32-bit value.">halCommonGetInt32uMillisecondTick()</a> ) is approximately 1 millisecond.</p>
<ul>
<li>When used with a 32.768kHz crystal, the system tick is 0.976 milliseconds.</li>
</ul>
<ul>
<li>When used with a 3.6864MHz crystal, the system tick is 1.111 milliseconds.</li>
</ul>
<p>A single quarter-second tick (as returned by <a class="el" href="group__system__timer.html#ga5aec52f8f5e5b85acacfb41a4a437593" title="Returns the current system time in quarter second ticks, as a 16-bit value.">halCommonGetInt16uQuarterSecondTick()</a> ) is approximately 0.25 seconds.</p>
<p>The values used by the time support functions will wrap after an interval. The length of the interval depends on the length of the tick and the number of bits in the value. However, there is no issue when comparing time deltas of less than half this interval with a subtraction, if all data types are the same.</p>
<p>See <a class="el" href="system-timer_8h.html" title="Header file for system_timer APIs.">system-timer.h</a> for source code. </p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="gacbbf0cd5321a6bd054b7e99c7b492f08"></a><!-- doxytag: member="system&#45;timer.h::halCommonGetInt16uMillisecondTick" ref="gacbbf0cd5321a6bd054b7e99c7b492f08" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__iar.html#ga409a5c4bea6981c30b308684efa33f6f">int16u</a> halCommonGetInt16uMillisecondTick </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the current system time in system ticks, as a 16-bit value. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>The least significant 16 bits of the current system time, in system ticks.</dd></dl>
<p>Return a 16 bit real time clock value. With 1024 clock ticks per second, a single clock tick occurs every 0.9769625 milliseconds, and a rollover of the 16-bit timer occurs every 64 seconds. </p>

<p>Definition at line <a class="el" href="system-timer_8c_source.html#l00035">35</a> of file <a class="el" href="system-timer_8c_source.html">system-timer.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga5aec52f8f5e5b85acacfb41a4a437593"></a><!-- doxytag: member="system&#45;timer.h::halCommonGetInt16uQuarterSecondTick" ref="ga5aec52f8f5e5b85acacfb41a4a437593" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__iar.html#ga409a5c4bea6981c30b308684efa33f6f">int16u</a> halCommonGetInt16uQuarterSecondTick </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the current system time in quarter second ticks, as a 16-bit value. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>The least significant 16 bits of the current system time, in system ticks multiplied by 256. </dd></dl>

<p>Definition at line <a class="el" href="system-timer_8c_source.html#l00040">40</a> of file <a class="el" href="system-timer_8c_source.html">system-timer.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga7033d63e4ee56452e3e6c67d49f01ef2"></a><!-- doxytag: member="system&#45;timer.h::halCommonGetInt32uMillisecondTick" ref="ga7033d63e4ee56452e3e6c67d49f01ef2" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__iar.html#ga2ba8e0357fdc7b7a450e6893ed81e8e3">int32u</a> halCommonGetInt32uMillisecondTick </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the current system time in system ticks, as a 32-bit value. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>The least significant 32 bits of the current system time, in system ticks.</dd></dl>
<p>Return a 32 bit real time clock value. With 1024 clock ticks per second, a single clock tick occurs every 0.9769625 milliseconds, and a rollover of the 32-bit timer occurs approximately every 48.5 days. </p>

<p>Definition at line <a class="el" href="system-timer_8c_source.html#l00050">50</a> of file <a class="el" href="system-timer_8c_source.html">system-timer.c</a>.</p>

</div>
</div>
<a class="anchor" id="gabf8fd2835f043631b926c49965ea178f"></a><!-- doxytag: member="system&#45;timer.h::halIdleForMilliseconds" ref="gabf8fd2835f043631b926c49965ea178f" args="(int32u *duration)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__micro.html#gafddf1f4a9c9eff790d56c8950c1fb0ad">StStatus</a> halIdleForMilliseconds </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__iar.html#ga2ba8e0357fdc7b7a450e6893ed81e8e3">int32u</a> *&nbsp;</td>
          <td class="paramname"> <em>duration</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Uses the system timer to enter <a class="el" href="group__micro.html#ggabed82baf7f470b522273a3e37c24c600a8dec81d54908044ef56016aee3b1b506">SLEEPMODE_IDLE</a> for approximately the specified amount of time (provided in milliseconds). </p>
<p>This function returns ST_SUCCESS and the duration parameter is decremented to 0 after idling for the specified amount of time. If an interrupt occurs that brings the chip out of idle, the function returns ST_SLEEP_INTERRUPTED and the duration parameter reports the amount of time remaining out of the original request.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>This routine always enables interrupts.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>duration</em>&nbsp;</td><td>The amount of time, expressed in milliseconds, that the micro should be placed into <a class="el" href="group__micro.html#ggabed82baf7f470b522273a3e37c24c600a8dec81d54908044ef56016aee3b1b506">SLEEPMODE_IDLE</a>. When the function returns, this parameter provides the amount of time remaining out of the original idle time request (normally the return value will be 0).</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>An StStatus value indicating the success or failure of the command. </dd></dl>

<p>Definition at line <a class="el" href="system-timer_8c_source.html#l00071">71</a> of file <a class="el" href="system-timer_8c_source.html">system-timer.c</a>.</p>

</div>
</div>
<a class="anchor" id="gae0b935fd7ac5ee0070e31fb43bf82fba"></a><!-- doxytag: member="system&#45;timer.h::halInternalStartSystemTimer" ref="gae0b935fd7ac5ee0070e31fb43bf82fba" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__iar.html#ga409a5c4bea6981c30b308684efa33f6f">int16u</a> halInternalStartSystemTimer </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initializes the system tick. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>Time to update the async registers after RTC is started (units of 100 microseconds). </dd></dl>

<p><p>ENABLE_OSC32K </p>
</p>

<p>Definition at line <a class="el" href="micro-common_8c_source.html#l00072">72</a> of file <a class="el" href="micro-common_8c_source.html">micro-common.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga93a6eee07d54f4485ee7d41d20377e33"></a><!-- doxytag: member="system&#45;timer.h::halSleepForQuarterSeconds" ref="ga93a6eee07d54f4485ee7d41d20377e33" args="(int32u *duration)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__micro.html#gafddf1f4a9c9eff790d56c8950c1fb0ad">StStatus</a> halSleepForQuarterSeconds </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__iar.html#ga2ba8e0357fdc7b7a450e6893ed81e8e3">int32u</a> *&nbsp;</td>
          <td class="paramname"> <em>duration</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Uses the system timer to enter <a class="el" href="group__micro.html#ggabed82baf7f470b522273a3e37c24c600a93af1c45a33be62df00d0ab82ef04128">SLEEPMODE_WAKETIMER</a> for approximately the specified amount of time (provided in quarter seconds). </p>
<p>This function returns ST_SUCCESS and the duration parameter is decremented to 0 after sleeping for the specified amount of time. If an interrupt occurs that brings the chip out of sleep, the function returns ST_SLEEP_INTERRUPTED and the duration parameter reports the amount of time remaining out of the original request.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>This routine always enables interrupts.</dd>
<dd>
The maximum sleep time of the hardware is limited on AVR-based platforms to 8 seconds, on EM2XX-based platforms to 64 seconds, and on EM35x platforms to 48.5 days. Any sleep duration greater than this limit will wake up briefly (e.g. 16 microseconds) to reenable another sleep cycle.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>duration</em>&nbsp;</td><td>The amount of time, expressed in quarter seconds, that the micro should be placed into <a class="el" href="group__micro.html#ggabed82baf7f470b522273a3e37c24c600a93af1c45a33be62df00d0ab82ef04128">SLEEPMODE_WAKETIMER</a>. When the function returns, this parameter provides the amount of time remaining out of the original sleep time request (normally the return value will be 0).</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>An StStatus value indicating the success or failure of the command. </dd></dl>

</div>
</div>
</div>
<hr size="1">

<table border="0" cellspacing="0" cellpadding="0" width=100%>

<tr>

<td><address><small>

Hardware Abstraction Level. <br>

1.0.0.

</small></address>

</td>

<td align="right">

<address><small>

Copyright &copy; 2009 by STMicrolectronics. All rights reserved.<br>

Generated Thu Apr 15 16:02:32 2010 with <a href="http://www.doxygen.org/index.html">Doxygen</a> 1.6.1.

</small></address>

</td>

</tr>

</table>

</body>

</html>
