inline void filter(double *din, double *dout, unsigned sx, unsigned sy, double *kernel, unsigned kdim); 
