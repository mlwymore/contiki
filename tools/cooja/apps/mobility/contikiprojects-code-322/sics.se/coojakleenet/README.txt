Installation instructions
--------------------------

First, download and install KleeNet from:

https://code.comsys.rwth-aachen.de/redmine/projects/kleenet-public.git

---
The COOJA/KleeNet project is not yet fully integrated with Contiki: you need to
change/replace a set of files in Contiki. Below instructions creates a new git 
branch with all the necessary changes, as was tested on Contiki downloaded 
on 1st November 2012.

Currently supported platforms: Linux/x86.

* Preparations

$ export CONTIKIPROJECTS=/path/to/contikiprojects
$ export COOJAKLEENET=$CONTIKIPROJECTS/sics.se/coojakleenet/

* Download Contiki from git (unless you already have it)

  $ git clone git://contiki.git.sourceforge.net/gitroot/contiki/contiki contiki-2.x
  $ export CONTIKI=/path/to/contiki-2.x

* Create a new coojakleenet branch

  $ cd $CONTIKI
  $ git checkout -b coojakleenet

* Replace original Contiki sources with Kleenet-compatible ones

  $ rsync -avC --include core $COOJAKLEENET/contiki-replace/ $CONTIKI/ # wo .svn
  or
  #$ cp -R $COOJAKLEENET/contiki-replace/* $CONTIKI/ # w .svn

* Commit modified files to coojakleenet branch
  $ cd $CONTIKI
  $ git add core platform
  $ git commit -a

* Compile COOJA/KleeNet plugin

  This plugin is the UI for the COOJA/KleeNet integration.
  It starts, monitors, and replays execution scenarios generated by KleeNet.
  First, build COOJA:

  $ cd $CONTIKI/tools/cooja
  $ ant jar

  Second, build the plugin and start COOJA:
  Note: You may need to update the build.xml, to correctly update the 
  cooja-property.

  $ cd $COOJAKLEENET/cooja-project
  $ ant jar
  #$ ant jar_and_cooja_run # Compiles and also immediately starts COOJA

  You now need to register this project inside COOJA. Start COOJA, and go to 
  Menu>Settings->Cooja extensions. Scroll to and select the cooja-project folder
  checkbox under the $COOJAKLEENET directory. Then click "Save">OK.
  The "COOJA/KleeNet" plugin has appeared in the "Tools" menu. Close COOJA.

* Run the SenSys'10 demo examples

  You find the examples presented at SenSys'10 in $COOJAKLEENET/examples.
  Start COOJA and load the demo simulation:
  * Make sure klee-gcc is accessible from your PATH.
  $ cd $CONTIKI/tools/cooja
  $ ant
  * Open $COOJAKLEENET/examples/demo1/client_router_server.csc
  $ Configure and start KleeNet
  $ Close the applet, parse, and replay the results (you can also parse and replay
    the results from the last KleeNet run directly wihout running KleeNet)
